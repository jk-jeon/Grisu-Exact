<html>
<head>
<script src="http://code.jquery.com/jquery-1.8.2.js"></script>
<script src="http://www.google.com/jsapi?autoload={'modules':[{'name':'visualization','version':'1','packages':['controls', 'charteditor']}]}"></script>
<script src="https://web.archive.org/web/20160324220311/http://jquery-csv.googlecode.com/git/src/jquery.csv.js"></script>
<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css">
<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
<script>
$(function() {
	google.load("visualization", "1", {packages:["corechart"]});

    var csv = $('#textInput').val();
    var data = $.csv.toArrays(csv, {
        onParseValue: $.csv.hooks.castToScalar
    });

    // Convert data for bar chart (summing all digits)
    var timeData = {};	// type -> table
    var funcRowMap;
    var maxDigit = 0;

    for (var i = 1; i < data.length; i++) {
    	var type = data[i][0];
   		var func = data[i][1];
      var digit = data[i][2];
   		var time = data[i][3];
   		if (timeData[type] == null) {
   			timeData[type] = [["Function", "Time (ns)"/*, { role: "style" }*/]];
        if (digit != 0)
   			  funcRowMap = {};
   		}

   		var table = timeData[type];
   		
      if (digit != 0) {
     		if (funcRowMap[func] == null)
     			funcRowMap[func] = table.push([func, 0]) - 1;
     		
     		table[funcRowMap[func]][1] += time;
      }
      else 
        table.push([func, time]);

      maxDigit = Math.max(maxDigit, digit);
    }

    // Compute average
    for (var type in timeData) {
      var table = timeData[type];
      for (var i = 1; i < table.length; i++)
        table[i][1] /= maxDigit;
    }

    // Convert data for drawing line chart per random digit
    var timeDigitData = {}; // type -> table
    var funcColumnMap;

    for (var i = 1; i < data.length; i++) {
    	var type = data[i][0];
   		var func = data[i][1];
		  var digit = data[i][2];
   		var time = data[i][3];

      if (digit == 0)
        continue;

   		if (timeDigitData[type] == null) {
   			timeDigitData[type] = [["Digit"]];
   			funcColumnMap = {};
   		}

   		var table = timeDigitData[type];

   		if (funcColumnMap[func] == null)
   			funcColumnMap[func] = table[0].push(func) - 1;

   		var row;
   		for (row = 1; row < table.length; row++)
   			if (table[row][0] == digit)
   				break;

    	if (row == table.length)
    		table.push([digit]);

		table[row][funcColumnMap[func]] = time;
	}

	for (var type in timeData) {
		$("#main").append(
      $("<a>", {name: type}),
      $("<h2>", {style: "padding-top: 70px; margin-top: -70px;"}).append(type)
    );

    $("#section").append($("<li>").append($("<a>", {href: "#" + type}).append(type)));

		drawTable(type, timeData[type]);
		drawBarChart(type, timeData[type]);
    if (timeDigitData[type] != null)
		  drawDigitChart(type, timeDigitData[type]);
	}

	$(".chart").each(function() {
		var chart = $(this);
		var d = $("#downloadDD").clone().css("display", "");
		$('li a', d).each(function() {
	        $(this).click(function() {
	            var svg = chart[0].getElementsByTagName('svg')[0].parentNode.innerHTML;
	            svg=sanitize(svg);
	            $('#imageFilename').val($("#title").html() + "_" + chart.data("filename"));
	            $('#imageGetFormTYPE').val($(this).attr('dltype'));
	            $('#imageGetFormSVG').val(svg);
	            $('#imageGetForm').submit();
	        });
	    });		
		$(this).after(d);
	});

  // Add configurations
  var thisConfig = "unknown_win64_vc2019";
  var configurations = ["corei7920@2.67_cygwin32_gcc4.8","corei7920@2.67_cygwin64_gcc4.8","corei7920@2.67_win32_vc2013","corei7920@2.67_win64_vc2013","unknown_mac32_clang7.0","unknown_mac64_clang7.0","unknown_win64_vc2019"];

  for (var i in configurations) {
    var c = configurations[i];
    $("#configuration").append($("<li>", {class : (c == thisConfig ? "active" : "")}).append($("<a>", {href: c + ".html"}).append(c)));
  }
});

function drawTable(type, timeData) {
	var data = google.visualization.arrayToDataTable(timeData);
    data.addColumn('number', 'Speedup');
    data.sort([{ column: 1, desc: true }]);
    var formatter1 = new google.visualization.NumberFormat({ fractionDigits: 3 });
    formatter1.format(data, 1);

	var div = document.createElement("div");
	div.className = "tablechart";
	$("#main").append(div);
    var table = new google.visualization.Table(div);
    redrawTable(0);
    table.setSelection([{ row: 0, column: null}]);

    function redrawTable(selectedRow) {
        // Compute relative time using the first row as basis
        var basis = data.getValue(selectedRow, 1);
        for (var rowIndex = 0; rowIndex < data.getNumberOfRows(); rowIndex++)
            data.setValue(rowIndex, 2, basis / data.getValue(rowIndex, 1));

        var formatter = new google.visualization.NumberFormat({suffix: 'x'});
        formatter.format(data, 2); // Apply formatter to second column

        table.draw(data);
    }

    google.visualization.events.addListener(table, 'select',
    function() {
        var selection = table.getSelection();
        if (selection.length > 0) {
            var item = selection[0];
            if (item.row != null)
                redrawTable(item.row);
        }
    });

}

function drawBarChart(type, timeData) {
    var defaultColors = ["#3366cc","#dc3912","#ff9900","#109618","#990099","#0099c6","#dd4477","#66aa00","#b82e2e","#316395","#994499","#22aa99","#aaaa11","#6633cc","#e67300","#8b0707","#651067","#329262","#5574a6","#3b3eac","#b77322","#16d620","#b91383","#f4359e","#9c5935","#a9c413","#2a778d","#668d1c","#bea413","#0c5922","#743411"];

	var data = google.visualization.arrayToDataTable(timeData);
	data.addColumn({ type: "string", role: "style" })
	for (var rowIndex = 0; rowIndex < data.getNumberOfRows(); rowIndex++)
		data.setValue(rowIndex, 2, defaultColors[rowIndex]);

    data.sort([{ column: 1, desc: true }]);
	var options = { 
		title: type,
		chartArea: {'width': '70%', 'height': '70%'},
		width: 800,
		height: 300,
		legend: { position: "none" },
		hAxis: { title: "Time (ns)" }
	};
	var div = document.createElement("div");
	div.className = "chart";
	$(div).data("filename", type + "_time");
	$("#main").append(div);
	var chart = new google.visualization.BarChart(div);

	chart.draw(data, options);
}

function drawDigitChart(type, timeDigitData) {
	var data = google.visualization.arrayToDataTable(timeDigitData);

	var options = { 
		title: type,
		chartArea: {'width': '70%', 'height': '80%'},
		hAxis: {
			title: "Digit",
			gridlines: { count: timeDigitData.length - 1 },
			maxAlternation: 1,
			minTextSpacing: 0
		},
		vAxis: {
			title: "Time (ns) in log scale",
			logScale: true,
			minorGridlines: { count: 10 },
      baseline: 0
		},
		width: 800,
		height: 600
	};
	var div = document.createElement("div");
	div.className = "chart";
	$(div).data("filename", type + "_timedigit");
	$("#main").append(div);
	var chart = new google.visualization.LineChart(div);

	chart.draw(data, options);
}

// http://jsfiddle.net/P6XXM/
function sanitize(svg) {
    svg = svg
        .replace(/\<svg/,'<svg xmlns="http://www.w3.org/2000/svg" version="1.1"')
        .replace(/zIndex="[^"]+"/g, '')
        .replace(/isShadow="[^"]+"/g, '')
        .replace(/symbolName="[^"]+"/g, '')
        .replace(/jQuery[0-9]+="[^"]+"/g, '')
        .replace(/isTracker="[^"]+"/g, '')
        .replace(/url\([^#]+#/g, 'url(#')
        .replace('<svg xmlns:xlink="http://www.w3.org/1999/xlink" ', '<svg ')
        .replace(/ href=/g, ' xlink:href=')
    /*.replace(/preserveAspectRatio="none">/g, 'preserveAspectRatio="none"/>')*/
    /* This fails in IE < 8
    .replace(/([0-9]+)\.([0-9]+)/g, function(s1, s2, s3) { // round off to save weight
    return s2 +'.'+ s3[0];
    })*/

    // IE specific
        .replace(/id=([^" >]+)/g, 'id="$1"')
        .replace(/class=([^" ]+)/g, 'class="$1"')
        .replace(/ transform /g, ' ')
        .replace(/:(path|rect)/g, '$1')
        .replace(/<img ([^>]*)>/gi, '<image $1 />')
        .replace(/<\/image>/g, '') // remove closing tags for images as they'll never have any content
        .replace(/<image ([^>]*)([^\/])>/gi, '<image $1$2 />') // closes image tags for firefox
        .replace(/width=(\d+)/g, 'width="$1"')
        .replace(/height=(\d+)/g, 'height="$1"')
        .replace(/hc-svg-href="/g, 'xlink:href="')
        .replace(/style="([^"]+)"/g, function (s) {
            return s.toLowerCase();
        });

    // IE9 beta bugs with innerHTML. Test again with final IE9.
    svg = svg.replace(/(url\(#highcharts-[0-9]+)&quot;/g, '$1')
        .replace(/&quot;/g, "'");
    if (svg.match(/ xmlns="/g).length == 2) {
        svg = svg.replace(/xmlns="[^"]+"/, '');
    }

    return svg;
}
</script>
<style type="text/css">
@media (min-width: 800px) {
  .container {
    max-width: 800px;
  }
}
textarea {
	font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace;
}
.tablechart {
	width: 700px;
	margin: auto;
	padding-top: 20px;
	padding-bottom: 20px;
}
.chart {
	padding-top: 20px;
	padding-bottom: 20px;
}
body { padding-top: 70px; }
</style>
</head>
<body>
<div class="container">
<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://github.com/miloyip/dtoa-benchmark"><span class="glyphicon glyphicon-home"></span> dtoa-benchmark</a>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">Configuration <span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu" id="configuration">
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">Section <span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu" id="section">
          </ul>
        </li>
      </ul>
      <p class="navbar-text navbar-right">Developed by <a href="https://github.com/miloyip" class="navbar-link">Milo Yip</a></p>
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>
<div class="page-header">
<h1 id="title">unknown_win64_vc2019</h1>
</div>
<div id="main"></div>
<h2>Source CSV</h2>
<textarea id="textInput" class="form-control" rows="5" readonly>
  Type,Function,Digit,Time(ns)
randomdigit,grisu_exact,1,48.919000
randomdigit,grisu_exact,2,53.048000
randomdigit,grisu_exact,3,52.727000
randomdigit,grisu_exact,4,51.563000
randomdigit,grisu_exact,5,53.659000
randomdigit,grisu_exact,6,52.639000
randomdigit,grisu_exact,7,53.093000
randomdigit,grisu_exact,8,51.417000
randomdigit,grisu_exact,9,53.637000
randomdigit,grisu_exact,10,54.788000
randomdigit,grisu_exact,11,53.633000
randomdigit,grisu_exact,12,52.184000
randomdigit,grisu_exact,13,53.729000
randomdigit,grisu_exact,14,52.354000
randomdigit,grisu_exact,15,53.762000
randomdigit,grisu_exact,16,52.463000
randomdigit,grisu_exact,17,51.143000
randomdigit,doubleconv,1,108.926000
randomdigit,doubleconv,2,121.965000
randomdigit,doubleconv,3,131.900000
randomdigit,doubleconv,4,138.213000
randomdigit,doubleconv,5,146.455000
randomdigit,doubleconv,6,147.455000
randomdigit,doubleconv,7,158.612000
randomdigit,doubleconv,8,156.200000
randomdigit,doubleconv,9,157.681000
randomdigit,doubleconv,10,156.761000
randomdigit,doubleconv,11,156.580000
randomdigit,doubleconv,12,159.580000
randomdigit,doubleconv,13,165.740000
randomdigit,doubleconv,14,171.665000
randomdigit,doubleconv,15,172.175000
randomdigit,doubleconv,16,173.250000
randomdigit,doubleconv,17,190.156000
randomdigit,emyg,1,75.135000
randomdigit,emyg,2,83.620000
randomdigit,emyg,3,85.578000
randomdigit,emyg,4,91.971000
randomdigit,emyg,5,95.818000
randomdigit,emyg,6,94.435000
randomdigit,emyg,7,97.440000
randomdigit,emyg,8,102.645000
randomdigit,emyg,9,103.855000
randomdigit,emyg,10,116.828000
randomdigit,emyg,11,110.675000
randomdigit,emyg,12,112.139000
randomdigit,emyg,13,114.638000
randomdigit,emyg,14,117.840000
randomdigit,emyg,15,119.338000
randomdigit,emyg,16,122.858000
randomdigit,emyg,17,129.593000
randomdigit,floaxie,1,48.937000
randomdigit,floaxie,2,58.194000
randomdigit,floaxie,3,65.000000
randomdigit,floaxie,4,74.667000
randomdigit,floaxie,5,82.124000
randomdigit,floaxie,6,89.867000
randomdigit,floaxie,7,99.245000
randomdigit,floaxie,8,107.611000
randomdigit,floaxie,9,112.901000
randomdigit,floaxie,10,118.300000
randomdigit,floaxie,11,119.454000
randomdigit,floaxie,12,122.761000
randomdigit,floaxie,13,122.203000
randomdigit,floaxie,14,124.399000
randomdigit,floaxie,15,127.758000
randomdigit,floaxie,16,127.737000
randomdigit,floaxie,17,128.419000
randomdigit,fmt,1,163.106000
randomdigit,fmt,2,173.028000
randomdigit,fmt,3,178.081000
randomdigit,fmt,4,190.062000
randomdigit,fmt,5,189.869000
randomdigit,fmt,6,193.857000
randomdigit,fmt,7,190.479000
randomdigit,fmt,8,193.079000
randomdigit,fmt,9,203.466000
randomdigit,fmt,10,197.054000
randomdigit,fmt,11,201.770000
randomdigit,fmt,12,219.054000
randomdigit,fmt,13,220.115000
randomdigit,fmt,14,208.618000
randomdigit,fmt,15,216.412000
randomdigit,fmt,16,215.385000
randomdigit,fmt,17,223.033000
randomdigit,fpconv,1,139.713000
randomdigit,fpconv,2,150.977000
randomdigit,fpconv,3,161.560000
randomdigit,fpconv,4,170.580000
randomdigit,fpconv,5,177.903000
randomdigit,fpconv,6,187.044000
randomdigit,fpconv,7,191.913000
randomdigit,fpconv,8,194.513000
randomdigit,fpconv,9,202.338000
randomdigit,fpconv,10,201.631000
randomdigit,fpconv,11,203.078000
randomdigit,fpconv,12,203.430000
randomdigit,fpconv,13,205.077000
randomdigit,fpconv,14,211.318000
randomdigit,fpconv,15,213.802000
randomdigit,fpconv,16,216.033000
randomdigit,fpconv,17,224.923000
randomdigit,grisu2,1,136.744000
randomdigit,grisu2,2,145.708000
randomdigit,grisu2,3,145.498000
randomdigit,grisu2,4,146.792000
randomdigit,grisu2,5,150.844000
randomdigit,grisu2,6,154.989000
randomdigit,grisu2,7,154.984000
randomdigit,grisu2,8,155.666000
randomdigit,grisu2,9,161.500000
randomdigit,grisu2,10,163.784000
randomdigit,grisu2,11,170.167000
randomdigit,grisu2,12,172.003000
randomdigit,grisu2,13,176.140000
randomdigit,grisu2,14,176.387000
randomdigit,grisu2,15,181.662000
randomdigit,grisu2,16,185.375000
randomdigit,grisu2,17,188.818000
randomdigit,jkj,1,45.893000
randomdigit,jkj,2,50.066000
randomdigit,jkj,3,51.083000
randomdigit,jkj,4,49.752000
randomdigit,jkj,5,48.668000
randomdigit,jkj,6,49.303000
randomdigit,jkj,7,48.339000
randomdigit,jkj,8,48.507000
randomdigit,jkj,9,49.096000
randomdigit,jkj,10,51.074000
randomdigit,jkj,11,49.682000
randomdigit,jkj,12,49.599000
randomdigit,jkj,13,49.145000
randomdigit,jkj,14,49.349000
randomdigit,jkj,15,49.221000
randomdigit,jkj,16,49.518000
randomdigit,jkj,17,51.894000
randomdigit,milo,1,65.348000
randomdigit,milo,2,75.016000
randomdigit,milo,3,80.350000
randomdigit,milo,4,84.761000
randomdigit,milo,5,85.792000
randomdigit,milo,6,87.634000
randomdigit,milo,7,91.132000
randomdigit,milo,8,92.717000
randomdigit,milo,9,97.268000
randomdigit,milo,10,98.438000
randomdigit,milo,11,102.951000
randomdigit,milo,12,104.409000
randomdigit,milo,13,108.929000
randomdigit,milo,14,111.670000
randomdigit,milo,15,114.105000
randomdigit,milo,16,155.093000
randomdigit,milo,17,145.050000
randomdigit,null,1,1.393000
randomdigit,null,2,1.393000
randomdigit,null,3,1.393000
randomdigit,null,4,1.395000
randomdigit,null,5,1.432000
randomdigit,null,6,1.433000
randomdigit,null,7,1.432000
randomdigit,null,8,1.433000
randomdigit,null,9,1.433000
randomdigit,null,10,1.393000
randomdigit,null,11,1.393000
randomdigit,null,12,1.393000
randomdigit,null,13,1.392000
randomdigit,null,14,1.393000
randomdigit,null,15,1.392000
randomdigit,null,16,1.393000
randomdigit,null,17,1.393000
randomdigit,ryu,1,81.815000
randomdigit,ryu,2,83.215000
randomdigit,ryu,3,82.764000
randomdigit,ryu,4,80.831000
randomdigit,ryu,5,79.341000
randomdigit,ryu,6,76.021000
randomdigit,ryu,7,71.163000
randomdigit,ryu,8,69.067000
randomdigit,ryu,9,68.481000
randomdigit,ryu,10,68.211000
randomdigit,ryu,11,64.665000
randomdigit,ryu,12,63.016000
randomdigit,ryu,13,61.875000
randomdigit,ryu,14,59.922000
randomdigit,ryu,15,58.481000
randomdigit,ryu,16,56.093000
randomdigit,ryu,17,55.568000
randomdigit,to_chars,1,92.385000
randomdigit,to_chars,2,90.745000
randomdigit,to_chars,3,90.185000
randomdigit,to_chars,4,88.020000
randomdigit,to_chars,5,84.625000
randomdigit,to_chars,6,80.024000
randomdigit,to_chars,7,80.780000
randomdigit,to_chars,8,77.044000
randomdigit,to_chars,9,75.282000
randomdigit,to_chars,10,75.432000
randomdigit,to_chars,11,72.105000
randomdigit,to_chars,12,69.839000
randomdigit,to_chars,13,68.496000
randomdigit,to_chars,14,67.544000
randomdigit,to_chars,15,65.702000
randomdigit,to_chars,16,63.429000
randomdigit,to_chars,17,65.007000
</textarea>
</div>
<div class="row" id="downloadDD" style="display: none">
<div class="btn-group pull-right" >
    <button class="btn dropdown-toggle" data-toggle="dropdown"><span class="glyphicon glyphicon-picture"></span></button>
    <ul class="dropdown-menu">
        <li><a tabindex="-1" href="#" dltype="image/jpeg">JPEG</a></li>
        <li><a tabindex="-1" href="#" dltype="image/png">PNG</a></li>
        <li><a tabindex="-1" href="#" dltype="application/pdf">PDF</a></li>
        <li><a tabindex="-1" href="#" dltype="image/svg+xml">SVG</a></li>
    </ul>
</div>
</div>
<form method="post" action="http://export.highcharts.com/" id="imageGetForm">
    <input type="hidden" name="filename" id="imageFilename" value="" />
    <input type="hidden" name="type" id="imageGetFormTYPE" value="" />
    <input type="hidden" name="width" value="900" />
    <input type="hidden" name="svg" value="" id="imageGetFormSVG" />
</form>
</div>
</body>
</html>